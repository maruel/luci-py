syntax = "proto3";

package google.internal.devtools.workerfarm.v1test1;

import "google/protobuf/any.proto";

service TaskManager {
  rpc GetNextTask(GetNextTaskRequest) returns (GetNextTaskResponse);
  rpc SyncTask(stream SyncTaskRequest) returns (stream SyncTaskResponse);
  rpc CompleteTask(CompleteTaskRequest) returns (CompleteTaskResponse);
}

message GetNextTaskRequest {
  string name = 1;
  string worker_name = 2;
}

message GetNextTaskResponse {
  string task_name = 1;
  google.protobuf.Any task = 2;
}

message SyncTaskRequest {
  string name = 1;
  google.protobuf.Any update = 2;
}

message SyncTaskResponse {
  bool cancelled = 1;
}

message CompleteTaskRequest {
  string name = 1;
  google.protobuf.Any result = 2;
  google.protobuf.Any metadata = 3;
}

message CompleteTaskResponse {}
