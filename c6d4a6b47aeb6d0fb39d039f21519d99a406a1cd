{
  "comments": [
    {
      "key": {
        "uuid": "31b904a7_f1c52bc1",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2207,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2019-09-11T04:43:59Z",
      "side": 1,
      "message": "nit: better to be 6 * 60 ?",
      "range": {
        "startLine": 2207,
        "startChar": 30,
        "endLine": 2207,
        "endChar": 35
      },
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82f003c7_123da019",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2207,
      "author": {
        "id": 1352545
      },
      "writtenOn": "2019-09-12T17:25:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "31b904a7_f1c52bc1",
      "range": {
        "startLine": 2207,
        "startChar": 30,
        "endLine": 2207,
        "endChar": 35
      },
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e10d7905_ca8b1a81",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2336,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2019-09-12T17:52:07Z",
      "side": 1,
      "message": "Can you add here right after this line but before the time mock:\n\n  self.assertEqual(([], 0, 0), task_scheduler.cron_handle_bot_died())\n\nand maybe an empty line before the time mock.",
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5cc5c5ef_ab1b2e47",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2340,
      "author": {
        "id": 1352545
      },
      "writtenOn": "2019-09-11T00:52:31Z",
      "side": 1,
      "message": "Here, task 1 and task 2 both are filtered by task_result.yield_run_result_keys_with_dead_bot() and processed inspite of having .dead_after_ts \u003d None for task 1. So, ideally task 1 should have been filtered out and only task 2 should be in the output list of the query. \nIf I put filter on state \u003d\u003d RUNNING (as before), it only outputs task 2.\n\nSame observation applied to the assert statement in the next line.\n\nIs the value for .dead_after_ts \u003d None not being written in DB immediately after it is set in task_scheduler._handle_dead_bot() or the query doesn\u0027t put any filter on fields with null values?",
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3dfd8e78_9ca9a1a4",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2340,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2019-09-11T04:43:59Z",
      "side": 1,
      "message": "I think there is delay in DB, but want maruel to confirm.",
      "parentUuid": "5cc5c5ef_ab1b2e47",
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7bb85ef7_d260a327",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2340,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2019-09-11T18:47:15Z",
      "side": 1,
      "message": "The DB is consistent in the unit tests, unless explicitly made eventually consistent.",
      "parentUuid": "3dfd8e78_9ca9a1a4",
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4deeb405_90639613",
        "filename": "appengine/swarming/server/task_scheduler_test.py",
        "patchSetId": 11
      },
      "lineNbr": 2340,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2019-09-12T17:52:07Z",
      "side": 1,
      "message": "Sadly I think it\u0027s a bug but I can\u0027t find where yet.\nIt could be a bug in the test though but I don\u0027t think so:\n\nIn practice, it means it looped on two tasks, but that doesn\u0027t make sense, there\u0027s only one task running. This basically means that when the first loop died, its dead_after_ts wasn\u0027t reset to None.",
      "parentUuid": "7bb85ef7_d260a327",
      "revId": "c6d4a6b47aeb6d0fb39d039f21519d99a406a1cd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}